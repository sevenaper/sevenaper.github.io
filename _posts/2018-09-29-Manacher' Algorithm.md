---
title: Manacher' Algorithm
key: 201809029
tags: 算法
---

谈到之前寻找最长回文子串，采用以某个字符为中心向两边延伸，算到最长的子串，这样的时间复杂度为$O(n^2)$，后来aper的好朋友TYP同学告诉本:hot_pepper::chicken:处理回文子串有一种线性的方法叫做马拉车，于是写篇文章来学习这个算法。

为了处理方便，我们先在字符串中插入某个不存在的字符，使得所有的回文都转化为奇回文。比如:aabb->a#a#b#b#，aacbb->a#a#c#b#b。然后设p[i]为以s[i]为中心的回文字符的半径，如果p[i]=1，那么s[i]的回文就是其本身。

| i    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20    | 21   | 22   | 23   | 24   | 25   | 26   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ---- | ---- | ---- | ---- | ---- | ---- |
| s[i] | $    | #    | a    | #    | b    | #    | b    | #    | a    | #    | T    | #    | N    | #    | T    | #    | a    | #    | b    | #    | **c** | #    | b    | #    | a    | #    | \0   |
| p[i] |      | 1    | 2    | 1    | 2    | 5    | 2    | 1    | 2    | 1    | 2    | 1    | 8    | 1    | 2    | 1    | 2    | 1    | 2    | 1    | **6** | 1    | 2    | 1    | 2    | 1    |      |
